# yaml-language-server: $schema=https://raw.githubusercontent.com/wundergraph/cosmo/main/router/pkg/config/config.schema.json
# Cosmo Router Configuration
# https://cosmo-docs.wundergraph.com/router/configuration

version: "1"

# Router execution config (generated by `wgc router compose`)
execution_config:
  file:
    path: "./router-config.json"

# Server configuration
listen_addr: "0.0.0.0:9991"

# Logging configuration
log_level: "info"

# Access logs: log subgraph requests so failures (e.g. admin-graphql down) are visible
access_logs:
  enabled: true
  level: "info"
  subgraphs:
    enabled: true
    fields:
      - key: "subgraph_error"
        value_from:
          context_field: "response_error_message"
      - key: "request_error"
        value_from:
          context_field: "request_error"

# Enable GraphQL Playground
playground_enabled: true
playground_path: "/"

# Enable GraphQL introspection
introspection:
  enabled: true

# GraphQL endpoint path
graphql_path: "/graphql"

# Health check endpoints
health_check_path: "/health"
readiness_check_path: "/health/ready"
liveness_check_path: "/health/live"

# CORS configuration
cors:
  allow_origins:
    - "http://localhost:3000"
    - "https://shop.shortlink.best"
  allow_methods:
    - "GET"
    - "POST"
    - "OPTIONS"
  allow_headers:
    - "Content-Type"
    - "Authorization"
    - "X-Request-ID"
  allow_credentials: true

# Telemetry configuration
telemetry:
  metrics:
    prometheus:
      enabled: true
      path: "/metrics"
      listen_addr: "0.0.0.0:8088"

# Traffic shaping
traffic_shaping:
  router:
    max_request_body_size: "5MB"
