# 1. Init delivery-graphql subgraph

Date: 2026-02-02

## Status

Accepted

## Context

Нужен GraphQL API для управления Delivery service из новой админ-панели (admin-ui).
Delivery service предоставляет gRPC API для управления курьерами и доставками.

Существующая Django админка (`admin/`) использует прямое gRPC подключение,
но для admin-ui выбрана архитектура через BFF (GraphQL Federation).

## Decision

Создаём новый сервис `delivery-graphql` как GraphQL subgraph для BFF:

1. **Технология**: Tailcall — декларативный gRPC→GraphQL gateway
2. **Порт**: 8102
3. **Federation**: Интеграция с Cosmo Router (BFF)

Преимущества Tailcall:
- Декларативная конфигурация (без кода)
- Минимальный overhead
- Встроенная поддержка gRPC
- Federation support

## Consequences

### Positive
- Единая точка входа через BFF для всех клиентов
- GraphQL типизация и introspection
- Возможность объединения данных из разных источников
- Консистентность с существующей архитектурой (oms-graphql, admin subgraph)

### Negative
- Дополнительный сервис для деплоя и мониторинга
- Latency overhead (один дополнительный hop)

## Links

- [Tailcall Documentation](https://tailcall.run/docs/)
- [Cosmo Router](https://cosmo-docs.wundergraph.com/)
- Delivery proto: `delivery/src/infrastructure/rpc/delivery.proto`
